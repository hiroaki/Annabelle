<!DOCTYPE html>
<html>
<head>
    <title>Flash Message Test</title>
    <style>
        .text-red-700 { color: #b91c1c; }
        .bg-red-100 { background-color: #fee2e2; }
        .text-blue-700 { color: #1d4ed8; }
        .bg-blue-100 { background-color: #dbeafe; }
        .text-yellow-700 { color: #a16207; }
        .bg-yellow-100 { background-color: #fef3c7; }
        .p-4 { padding: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
        .text-sm { font-size: 0.875rem; }
        .rounded-lg { border-radius: 0.5rem; }
    </style>
</head>
<body>
    <!-- Flash Storage Container (hidden) - for staging flash messages before rendering -->
    <div id="flash-storage" style="display: none;">
        <ul>
            <li data-type="alert">Test alert message</li>
            <li data-type="notice">Test notice message</li>
        </ul>
    </div>
    
    <!-- Flash Message Display Container - global flash message display area -->
    <div id="flash-message-container"></div>
    
    <script>
        // Copy the flash_messages.js content here to test
        function renderFlashMessages() {
          const storage = document.getElementById('flash-storage');
          const container = document.getElementById('flash-message-container');
          if (!storage || !container) return;
          
          const ul = storage.querySelector('ul');
          if (!ul || ul.children.length === 0) return; // Early return for performance
          
          container.innerHTML = '';
          
          // Existing style definitions from original _flash.html.erb
          const flashStyles = {
            alert: 'text-red-700 bg-red-100',
            notice: 'text-blue-700 bg-blue-100',
            warning: 'text-yellow-700 bg-yellow-100'
          };
          
          ul.querySelectorAll('li').forEach(li => {
            const type = li.dataset.type || 'notice';
            const message = li.textContent.trim();
            
            // Skip empty messages
            if (!message) return;
            
            const div = document.createElement('div');
            
            // Use same styles and data attributes as original _flash.html.erb
            const style = flashStyles[type] || flashStyles['warning'];
            div.className = `p-4 mb-4 text-sm ${style} rounded-lg`;
            div.setAttribute('role', 'alert');
            div.setAttribute('data-testid', 'flash-message');
            div.setAttribute('data-controller', 'dismissable');
            div.textContent = message;
            
            container.appendChild(div);
          });
          
          ul.innerHTML = '';
        }

        function addFlashMessageToStorage(message, type = 'alert') {
          const storage = document.getElementById('flash-storage');
          if (!storage) return;
          
          let ul = storage.querySelector('ul');
          if (!ul) {
            ul = document.createElement('ul');
            storage.appendChild(ul);
          }
          
          const li = document.createElement('li');
          li.dataset.type = type;
          li.textContent = message;
          ul.appendChild(li);
        }

        // Test on page load
        document.addEventListener('DOMContentLoaded', function() {
            renderFlashMessages();
        });
    </script>
    
    <button onclick="addFlashMessageToStorage('Client message', 'warning'); renderFlashMessages();">Add Client Message</button>
    <button onclick="document.getElementById('flash-message-container').innerHTML = '';">Clear Messages</button>
</body>
</html>